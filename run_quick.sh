#!/bin/bash
#PBS -l walltime=80:15:00
#PBS -l nodes=1:ppn=2:gpus=1,mem=100GB
#PBS -A PAS2099
#PBS -N jike338
#PBS -j oe
#PBS -m be
#SBATCH --output=script1/R-%x.%j.out
module load python
module load cuda


cd /fs/ess/scratch/PAS2099/jike/DelayBN

# python3 main_fl_clean2.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 100  -b 20 --frac 1 --method step --alpha 0 --rounds 640 --num_data 50000 --lr 0.02 --num_users 5 --norm_layer BatchNorm --freeze_bn_at_round 1  --log_every_round 5 --id after_submission/tensorboard/BN_step_100_shards_delay_1_update_all > after_submission/BN_step_100_shards_delay_1_update_all.txt
# python3 main_fl_clean2.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 100  -b 20 --frac 1 --method step --alpha 0 --rounds 640 --num_data 50000 --lr 0.02 --num_users 5 --norm_layer BatchNorm --freeze_bn_at_round 320  --log_every_round 5 --id after_submission/tensorboard/BN_step_100_shards_delay_320_update_all > after_submission/BN_step_100_shards_delay_320_update_all.txt
# python3 main_fl_clean2.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 100  -b 20 --frac 1 --method step --alpha 0 --rounds 640 --num_data 49000 --lr 0.02 --num_users 5 --norm_layer BatchNorm --freeze_bn_at_round 320  --log_every_round 5 --id after_submission/tensorboard/BN_step_100_shards_delay_320_update_all > after_submission/BN_step_100_shards_delay_320_update_all.txt
# python3 main_fl_clean.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 10  -b 20 --frac 1 --method step --alpha 0 --rounds 640 --num_data 49000 --lr 0.02 --num_users 5 --norm_layer BatchNorm --freeze_bn_at_round 320  --log_every_round 5 --id after_submission/tensorboard/test > after_submission/test.txt

# python3 main_fl_clean.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 100  -b 20 --frac 1 --method step --alpha 0 --rounds 640 --num_data 50000 --lr 0.02 --num_users 5 --norm_layer BatchNorm --freeze_bn_at_round 1 --log_every_round 5 --id after_submission/tensorboard/BN_step_100_shards_delay_1 > after_submission/BN_step_100_shards_delay_1.txt
# python3 main_fl_clean.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 500  -b 20 --frac 1 --method step --alpha 0 --rounds 128 --num_data 50000 --lr 0.02 --num_users 5 --norm_layer BatchNorm --freeze_bn_at_round 64 --log_every_round 5 --id after_submission/tensorboard/BN_step_500_shards_delay_64 > after_submission/BN_step_500_shards_delay_64.txt
# python3 main_fl_clean2.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 500  -b 20 --frac 1 --method step --alpha 0 --rounds 128 --num_data 50000 --lr 0.02 --num_users 5 --norm_layer BatchNorm --freeze_bn_at_round 64 --log_every_round 5 --id after_submission/tensorboard/BN_step_500_shards_delay_64_update_all > after_submission/BN_step_500_shards_delay_64_update_all.txt

# python3 main_fl_clean.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 100  -b 20 --frac 1 --method step --alpha 0 --rounds 640 --num_data 50000 --lr 0.02 --num_users 5 --norm_layer BatchNorm --log_every_round 5 --id after_submission/tensorboard/BN_step_100_shards > after_submission/BN_step_100_shards.txt
# python3 main_fl_clean.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 100  -b 20 --frac 1 --method step --alpha 0 --rounds 640 --num_data 50000 --lr 0.02 --num_users 5 --norm_layer BatchNorm --freeze_bn_at_round 320 --log_every_round 5 --id harry/tensorboard/BN_noactivs_step_100_shards_2 > harry/BN_noactivs_step_100_shards_2.txt

# python3 main_fl_clean_step1_local_mom.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 1  -b 20 --frac 1 --method step --alpha 0 --rounds 64000 --num_data 50000 --lr 0.2 --num_users 5 --norm_layer BatchNorm --freeze_bn_at_round 32000 --id after_submission/tensorboard/BN_noactivs_step_1_shards_delay_half > after_submission/BN_noactivs_step_1_shards_delay_half.txt
# python3 main_fl_clean_step1_local_mom2.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 1  -b 20 --frac 1 --method step --alpha 0 --rounds 64000 --num_data 50000 --lr 0.2 --num_users 5 --norm_layer BatchNorm --freeze_bn_at_round 32000 --id after_submission/tensorboard/BN_noactivs_step_1_shards_delay_half_update_all > after_submission/BN_noactivs_step_1_shards_delay_half_update_all.txt



# python3 main_fl_clean_old.py --dataset tiny --data /fs/scratch/PAS2099/pfl_final/data_/data/tiny-imagenet-200 -a resnet18 --print-freq 100 --steps 500 -b 20 --frac 0.5 --method step --alpha 0 --rounds 251 --num_data 98000 --lr 0.02 --num_users 10 --norm_layer BatchNorm --log_every_round 10 --id final_poll_tiny/tensorboard/save_step100 > final_poll_tiny/save_step100.txt

# python3 main_fl_clean_old.py --dataset tiny --data /fs/scratch/PAS2099/pfl_final/data_/data/tiny-imagenet-200 -a resnet18 --print-freq 100 --steps 100 -b 20 --frac 0.5 --method step --alpha 0 --rounds 1280 --num_data 98000 --lr 0.02 --num_users 10 --norm_layer BatchNorm --log_every_round 100 --id final_poll_tiny/tensorboard/save_step100_2 > final_poll_tiny/save_step100_2.txt
# 
# python3 main_fl_clean_old.py --dataset tiny --data /fs/scratch/PAS2099/pfl_final/data_/data/tiny-imagenet-200 -a resnet18 --print-freq 100 --steps 500 -b 20 --frac 0.5 --method step --alpha 0 --rounds 251 --num_data 98000 --lr 0.02 --num_users 10 --norm_layer InstanceNorm --id final_poll_tiny/tensorboard/resnet18_IN_step500_shards > final_poll_tiny/resnet18_IN_step500_shards.txt
# python3 main_fl_clean_old.py --dataset tiny --data /fs/scratch/PAS2099/pfl_final/data_/data/tiny-imagenet-200 -a resnet18 --print-freq 100 --steps 500 -b 20 --frac 0.5 --method dir --alpha 0.1 --rounds 251 --num_data 98000 --lr 0.02 --num_users 10 --norm_layer InstanceNorm --id final_poll_tiny/tensorboard/resnet18_IN_step500_01 > final_poll_tiny/resnet18_IN_step500_01.txt
# python3 main_fl_clean_old.py --dataset tiny --data /fs/scratch/PAS2099/pfl_final/data_/data/tiny-imagenet-200 -a resnet18 --print-freq 100 --steps 500 -b 20 --frac 0.5 --method dir --alpha 0.3 --rounds 251 --num_data 98000 --lr 0.02 --num_users 10 --norm_layer InstanceNorm --id final_poll_tiny/tensorboard/resnet18_IN_step500_03 > final_poll_tiny/resnet18_IN_step500_03.txt
# python3 main_fl_clean_old.py --dataset tiny --data /fs/scratch/PAS2099/pfl_final/data_/data/tiny-imagenet-200 -a resnet18 --print-freq 100 --steps 500 -b 20 --frac 0.5 --method dir --alpha 0.6 --rounds 251 --num_data 98000 --lr 0.02 --num_users 10 --norm_layer InstanceNorm --id final_poll_tiny/tensorboard/resnet18_IN_step500_06 > final_poll_tiny/resnet18_IN_step500_06.txt
# python3 main_fl_clean_old.py --dataset tiny --data /fs/scratch/PAS2099/pfl_final/data_/data/tiny-imagenet-200 -a resnet18 --print-freq 100 --steps 500 -b 20 --frac 0.5 --method dir --alpha 100 --rounds 251 --num_data 98000 --lr 0.02 --num_users 10 --norm_layer InstanceNorm --id final_poll_tiny/tensorboard/resnet18_IN_step500_100 > final_poll_tiny/resnet18_IN_step500_100.txt

# python3 main_fl_clean_old.py --dataset tiny --data /fs/scratch/PAS2099/pfl_final/data_/data/tiny-imagenet-200 -a resnet18 --print-freq 100 --steps 500 -b 20 --frac 0.5 --method step --alpha 0 --rounds 251 --num_data 98000 --lr 0.02 --num_users 10 --norm_layer LayerNorm --id final_poll_tiny/tensorboard/resnet18_LN_step500_shards > final_poll_tiny/resnet18_LN_step500_shards.txt
# python3 main_fl_clean_old.py --dataset tiny --data /fs/scratch/PAS2099/pfl_final/data_/data/tiny-imagenet-200 -a resnet18 --print-freq 100 --steps 500 -b 20 --frac 0.5 --method dir --alpha 0.1 --rounds 251 --num_data 98000 --lr 0.02 --num_users 10 --norm_layer LayerNorm --id final_poll_tiny/tensorboard/resnet18_LN_step500_01 > final_poll_tiny/resnet18_LN_step500_01.txt
# python3 main_fl_clean_old.py --dataset tiny --data /fs/scratch/PAS2099/pfl_final/data_/data/tiny-imagenet-200 -a resnet18 --print-freq 100 --steps 500 -b 20 --frac 0.5 --method dir --alpha 0.3 --rounds 251 --num_data 98000 --lr 0.02 --num_users 10 --norm_layer LayerNorm --id final_poll_tiny/tensorboard/resnet18_LN_step500_03 > final_poll_tiny/resnet18_LN_step500_03.txt
# python3 main_fl_clean_old.py --dataset tiny --data /fs/scratch/PAS2099/pfl_final/data_/data/tiny-imagenet-200 -a resnet18 --print-freq 100 --steps 500 -b 20 --frac 0.5 --method dir --alpha 0.6 --rounds 251 --num_data 98000 --lr 0.02 --num_users 10 --norm_layer LayerNorm --id final_poll_tiny/tensorboard/resnet18_LN_step500_06 > final_poll_tiny/resnet18_LN_step500_06.txt
# python3 main_fl_clean_old.py --dataset tiny --data /fs/scratch/PAS2099/pfl_final/data_/data/tiny-imagenet-200 -a resnet18 --print-freq 100 --steps 500 -b 20 --frac 0.5 --method dir --alpha 100 --rounds 251 --num_data 98000 --lr 0.02 --num_users 10 --norm_layer LayerNorm --id final_poll_tiny/tensorboard/resnet18_LN_step500_100 > final_poll_tiny/resnet18_LN_step500_100.txt


# python3 main_fl_clean_step1.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 1  -b 20 --frac 1 --method step --alpha 0 --rounds 64000 --num_data 49000 --lr 0.2 --num_users 5 --norm_layer Identity --log_every_round 200 --id final_poll_cifar10/tensorboard/DelayBN_noactivs_step_1_shards_identity > final_poll_cifar10/DelayBN_noactivs_step_1_shards_identity.txt
# python3 main_fl_clean_step1.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 1  -b 20 --frac 1 --method step --alpha 0 --rounds 64000 --num_data 49000 --lr 0.2 --num_users 5 --norm_layer Identity --log_every_round 200 --id final_poll_cifar10/tensorboard/DelayBN_noactivs_step_1_shards_identity2 > final_poll_cifar10/DelayBN_noactivs_step_1_shards_identit2.txt
# python3 main_fl_clean_step1.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 1  -b 20 --frac 1 --method step --alpha 0 --rounds 64000 --num_data 49000 --lr 0.2 --num_users 5 --norm_layer Identity --log_every_round 200 --id final_poll_cifar10/tensorboard/DelayBN_noactivs_step_1_shards_identity3 > final_poll_cifar10/DelayBN_noactivs_step_1_shards_identit3.txt


# python3 main_fl_clean_local_mom.py --dataset tiny --data /fs/scratch/PAS2099/pfl_final/data_/data/tiny-imagenet-200 -a resnet18 --print-freq 100 --steps 500 -b 20 --frac 0.5 --method dir --alpha 0.6 --rounds 251 --num_data 98000 --lr 0.02 --num_users 10 --norm_layer BatchNorm --id final_poll_tiny/tensorboard/resnet18_BN_step500_06_LM > final_poll_tiny/resnet18_BN_step500_06_LM.txt
# python3 main_fl_clean_local_mom.py --dataset tiny --data /fs/scratch/PAS2099/pfl_final/data_/data/tiny-imagenet-200 -a resnet18 --print-freq 100 --steps 500 -b 20 --frac 0.5 --method dir --alpha 0.1 --rounds 251 --num_data 98000 --lr 0.02 --num_users 10 --norm_layer BatchNorm --id final_poll_tiny/tensorboard/resnet18_BN_step500_01_LM > final_poll_tiny/resnet18_BN_step500_01_LM.txt
# python3 main_fl_clean_local_mom.py --dataset tiny --data /fs/scratch/PAS2099/pfl_final/data_/data/tiny-imagenet-200 -a resnet18 --print-freq 100 --steps 500 -b 20 --frac 0.5 --method dir --alpha 0.3 --rounds 251 --num_data 98000 --lr 0.02 --num_users 10 --norm_layer BatchNorm --id final_poll_tiny/tensorboard/resnet18_BN_step500_03_LM > final_poll_tiny/resnet18_BN_step500_03_LM.txt
# python3 main_fl_clean_local_mom.py --dataset tiny --data /fs/scratch/PAS2099/pfl_final/data_/data/tiny-imagenet-200 -a resnet18 --print-freq 100 --steps 500 -b 20 --frac 0.5 --method dir --alpha 100 --rounds 251 --num_data 98000 --lr 0.02 --num_users 10 --norm_layer BatchNorm --id final_poll_tiny/tensorboard/resnet18_BN_step500_100_LM > final_poll_tiny/resnet18_BN_step500_100_LM.txt



# python3 main_fl_clean_step1.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 1  -b 20 --frac 1 --method step --alpha 0 --rounds 64000 --num_data 50000 --lr 0.2 --num_users 5 --norm_layer BN_WeightNorm --log_every_round 200 --id final_poll_wn/tensorboard/step_1_lr02_BN_WNxxxx > final_poll_wn/step_1_lr02_BN_WNxxxx.txt
# python3 main_fl_clean.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 20  -b 20 --frac 1 --method step --alpha 0 --rounds 3200 --num_data 50000 --lr 0.02 --num_users 5 --norm_layer BN_WeightNorm --log_every_round 20 --id final_poll_wn/tensorboard/step_20_BN_WNxxxx > final_poll_wn/step_20_BN_WNxxxx.txt
# python3 main_fl_clean_old.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 100  -b 20 --frac 1 --method step --alpha 0 --rounds 6400 --num_data 50000 --lr 0.02 --num_users 5 --norm_layer BN_WeightNorm --log_every_round 10 --id final_poll_wn/tensorboard/step_100_BN_WNxxxx > final_poll_wn/step_100_BN_WNxxxx.txt
# python3 main_fl_clean_old.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 500 -b 20 --frac 1 --method step --alpha 0 --rounds 128 --num_data 50000 --lr 0.02 --num_users 5 --norm_layer BN_WeightNorm --log_every_round 5 --id final_poll_wn/tensorboard/step_500_BN_WNxxxx > final_poll_wn/step_500_BN_WNxxxx.txt
# python3 main_fl_clean_old.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 2500  -b 20 --frac 1 --method step --alpha 0 --rounds 26 --num_data 50000 --lr 0.02 --num_users 5 --norm_layer BN_WeightNorm --log_every_round 1 --id final_poll_wn/tensorboard/step_2500_BN_WNxxxx > final_poll_wn/step_2500_BN_WNxxxx.txt

# python3 main_fl_clean_step1.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 1  -b 20 --frac 1 --method step --alpha 0 --rounds 64000 --num_data 50000 --lr 0.2 --num_users 5 --norm_layer GN_WeightNorm --log_every_round 200 --id final_poll_wn/tensorboard/step_1_lr02_GN_WNxxxx > final_poll_wn/step_1_lr02_GN_WNxxxx.txt
# python3 main_fl_clean.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 20  -b 20 --frac 1 --method step --alpha 0 --rounds 3200 --num_data 50000 --lr 0.02 --num_users 5 --norm_layer GN_WeightNorm --log_every_round 20 --id final_poll_wn/tensorboard/step_20_GN_WNxxxx > final_poll_wn/step_20_GN_WNxxxx.txt
# python3 main_fl_clean_old.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 100  -b 20 --frac 1 --method step --alpha 0 --rounds 6400 --num_data 50000 --lr 0.02 --num_users 5 --norm_layer GN_WeightNorm --log_every_round 10 --id final_poll_wn/tensorboard/step_100_GN_WNxxxx > final_poll_wn/step_100_GN_WNxxxx.txt
# python3 main_fl_clean_old.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 500 -b 20 --frac 1 --method step --alpha 0 --rounds 128 --num_data 50000 --lr 0.02 --num_users 5 --norm_layer GN_WeightNorm --log_every_round 5 --id final_poll_wn/tensorboard/step_500_GN_WNxxxx > final_poll_wn/step_500_GN_WNxxxx.txt
# python3 main_fl_clean_old.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 2500  -b 20 --frac 1 --method step --alpha 0 --rounds 26 --num_data 50000 --lr 0.02 --num_users 5 --norm_layer GN_WeightNorm --log_every_round 1 --id final_poll_wn/tensorboard/step_2500_GN_WNxxxx > final_poll_wn/step_2500_GN_WNxxxx.txt

# python3 main_fl_clean_step1_w_mom.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 1  -b 20 --frac 1 --method step --alpha 0 --rounds 64000 --num_data 50000 --lr 0.002 --num_users 5 --norm_layer GN_WeightNorm --log_every_round 200 --id final_poll_wn/tensorboard/step_1_lr0002_MOM_GN_WN > final_poll_wn/step_1_lr0002_MOM_GN_WN.txt
# python3 main_fl_clean_step1_w_mom.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 1  -b 20 --frac 1 --method step --alpha 0 --rounds 64000 --num_data 50000 --lr 0.002 --num_users 5 --norm_layer BatchNorm --log_every_round 200 --id final_poll_wn/tensorboard/step_1_lr0002_MOM_BN_2 > final_poll_wn/step_1_lr0002_MOM_BN_2.txt
# python3 main_fl_clean_step1_w_mom.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 1  -b 20 --frac 1 --method step --alpha 0 --rounds 64000 --num_data 50000 --lr 0.002 --num_users 5 --norm_layer GroupNorm --log_every_round 200 --id final_poll_wn/tensorboard/step_1_lr0002_MOM_GN_2 > final_poll_wn/step_1_lr0002_MOM_GN_2.txt

# python3 main_fl_clean_step1.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 1  -b 20 --frac 1 --method step --alpha 0 --rounds 64000 --num_data 50000 --lr 0.002 --num_users 5 --norm_layer BN_WeightNorm --log_every_round 200 --id final_poll_wn/tensorboard/step_1_lr0002_BN_WN > final_poll_wn/step_1_lr0002_BN_WN.txt
# python3 main_fl_clean_step1.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 1  -b 20 --frac 1 --method step --alpha 0 --rounds 64000 --num_data 50000 --lr 0.002 --num_users 5 --norm_layer GN_WeightNorm --log_every_round 200 --id final_poll_wn/tensorboard/step_1_lr0002_GN_WN > final_poll_wn/step_1_lr0002_GN_WN.txt
# python3 main_fl_clean_step1.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 1  -b 20 --frac 1 --method step --alpha 0 --rounds 64000 --num_data 50000 --lr 0.002 --num_users 5 --norm_layer BatchNorm --log_every_round 200 --id final_poll_wn/tensorboard/step_1_lr0002_BN > final_poll_wn/step_1_lr0002_BN.txt
# python3 main_fl_clean_step1.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 1  -b 20 --frac 1 --method step --alpha 0 --rounds 64000 --num_data 50000 --lr 0.002 --num_users 5 --norm_layer GroupNorm --log_every_round 200 --id final_poll_wn/tensorboard/step_1_lr0002_GN > final_poll_wn/step_1_lr0002_GN.txt

# python3 main_fl_clean_step1_w_mom.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 1  -b 20 --frac 1 --method step --alpha 0 --rounds 64000 --num_data 50000 --lr 0.02 --num_users 5 --norm_layer BN_WeightNorm --log_every_round 200 --id final_poll_wn/tensorboard/step_1_lr002_MOM_BN_WN > final_poll_wn/step_1_lr002_MOM_BN_WN.txt
# python3 main_fl_clean_step1_w_mom.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 1  -b 20 --frac 1 --method step --alpha 0 --rounds 64000 --num_data 50000 --lr 0.02 --num_users 5 --norm_layer GN_WeightNorm --log_every_round 200 --id final_poll_wn/tensorboard/step_1_lr002_MOM_GN_WN > final_poll_wn/step_1_lr002_MOM_GN_WN.txt
# python3 main_fl_clean_step1_w_mom.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 1  -b 20 --frac 1 --method step --alpha 0 --rounds 64000 --num_data 50000 --lr 0.02 --num_users 5 --norm_layer BatchNorm --log_every_round 200 --id final_poll_wn/tensorboard/step_1_lr002_MOM_BN > final_poll_wn/step_1_lr002_MOM_BN.txt
# python3 main_fl_clean_step1_w_mom.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 1  -b 20 --frac 1 --method step --alpha 0 --rounds 64000 --num_data 50000 --lr 0.02 --num_users 5 --norm_layer GroupNorm --log_every_round 200 --id final_poll_wn/tensorboard/step_1_lr002_MOM_GN > final_poll_wn/step_1_lr002_MOM_GN.txt

# python3 main_fl_clean_step1.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 1  -b 20 --frac 1 --method step --alpha 0 --rounds 64000 --num_data 50000 --lr 0.02 --num_users 5 --norm_layer BN_WeightNorm --log_every_round 200 --id final_poll_wn/tensorboard/step_1_lr002_BN_WN_2 > final_poll_wn/step_1_lr002_BN_WN_2.txt
# python3 main_fl_clean_step1.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 1  -b 20 --frac 1 --method step --alpha 0 --rounds 64000 --num_data 50000 --lr 0.02 --num_users 5 --norm_layer GN_WeightNorm --log_every_round 200 --id final_poll_wn/tensorboard/step_1_lr002_GN_WN_2 > final_poll_wn/step_1_lr002_GN_WN_2.txt
# python3 main_fl_clean_step1.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 1  -b 20 --frac 1 --method step --alpha 0 --rounds 64000 --num_data 50000 --lr 0.02 --num_users 5 --norm_layer BatchNorm --log_every_round 200 --id final_poll_wn/tensorboard/step_1_lr002_BN_2 > final_poll_wn/step_1_lr002_BN_2.txt
# python3 main_fl_clean_step1.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 1  -b 20 --frac 1 --method step --alpha 0 --rounds 64000 --num_data 50000 --lr 0.02 --num_users 5 --norm_layer GroupNorm --log_every_round 200 --id final_poll_wn/tensorboard/step_1_lr002_GN_2 > final_poll_wn/step_1_lr002_GN_2.txt

# python3 main_fl_clean_w_mom.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 100  -b 20 --frac 1 --method step --alpha 0 --rounds 640 --num_data 50000 --lr 0.002 --num_users 5 --norm_layer BN_WeightNorm --log_every_round 2 --id final_poll_wn/tensorboard/step_100_lr0002_MOM_BN_WN_2 > final_poll_wn/step_100_lr0002_MOM_BN_WN_2.txt
# python3 main_fl_clean_w_mom.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 100  -b 20 --frac 1 --method step --alpha 0 --rounds 640 --num_data 50000 --lr 0.002 --num_users 5 --norm_layer GN_WeightNorm --log_every_round 2 --id final_poll_wn/tensorboard/step_100_lr0002_MOM_GN_WN_2 > final_poll_wn/step_100_lr0002_MOM_GN_WN_2.txt
# python3 main_fl_clean_w_mom.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 100  -b 20 --frac 1 --method step --alpha 0 --rounds 640 --num_data 50000 --lr 0.002 --num_users 5 --norm_layer BatchNorm --log_every_round 2 --id final_poll_wn/tensorboard/step_100_lr0002_MOM_BN_2 > final_poll_wn/step_100_lr0002_MOM_BN_2.txt
# python3 main_fl_clean_w_mom.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 100  -b 20 --frac 1 --method step --alpha 0 --rounds 640 --num_data 50000 --lr 0.002 --num_users 5 --norm_layer GroupNorm --log_every_round 2 --id final_poll_wn/tensorboard/step_100_lr0002_MOM_GN_2 > final_poll_wn/step_100_lr0002_MOM_GN_2.txt

# python3 main_fl_clean.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 100  -b 20 --frac 1 --method step --alpha 0 --rounds 640 --num_data 50000 --lr 0.002 --num_users 5 --norm_layer BN_WeightNorm --log_every_round 2 --id final_poll_wn/tensorboard/step_100_lr0002_BN_WN_2 > final_poll_wn/step_100_lr0002_BN_WN_2.txt
# python3 main_fl_clean.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 100  -b 20 --frac 1 --method step --alpha 0 --rounds 640 --num_data 50000 --lr 0.002 --num_users 5 --norm_layer GN_WeightNorm --log_every_round 2 --id final_poll_wn/tensorboard/step_100_lr0002_GN_WN_2 > final_poll_wn/step_100_lr0002_GN_WN_2.txt
# python3 main_fl_clean.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 100  -b 20 --frac 1 --method step --alpha 0 --rounds 640 --num_data 50000 --lr 0.002 --num_users 5 --norm_layer BatchNorm --log_every_round 2 --id final_poll_wn/tensorboard/step_100_lr0002_BN_2 > final_poll_wn/step_100_lr0002_BN_2.txt
# python3 main_fl_clean.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 100  -b 20 --frac 1 --method step --alpha 0 --rounds 640 --num_data 50000 --lr 0.002 --num_users 5 --norm_layer GroupNorm --log_every_round 2 --id final_poll_wn/tensorboard/step_100_lr0002_GN_2 > final_poll_wn/step_100_lr0002_GN_2.txt

# python3 inference.py --dataset tiny  -a resnet18 --print-freq 100 --norm_layer BatchNorm -b 100 --lr 0.1 --pretrained  /fs/ess/scratch/PAS2099/jike/DelayBN/save_model/models/resnet18_shards_step100_bs20_no_delay_tiny_checkpoint_r1900.pth.tar > test/test3.txt

# python3 inference.py --dataset tiny --data /fs/scratch/PAS2099/pfl_final/data_/data/tiny-imagenet-200 -a resnet18 --print-freq 100 --norm_layer BatchNorm -b 20 --lr 0.1 --pretrained  /fs/ess/scratch/PAS2099/jike/DelayBN/exp/models/save_model_normal_checkpoint_r9800.pth.tar > test/test3.txt


# python3 main_centralized.py --dataset cifar10  -a resnet20 --print-freq 100 --norm_layer GroupNorm -b 100 --lr 0.1 > harry/GN_1.txt
# python3 main_centralized.py --dataset cifar10  -a resnet20 --print-freq 100 --norm_layer GroupNorm -b 100 --lr 0.1 > harry/GN_2.txt

# python3 main_fl_clean.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 1  -b 20 --frac 1 --method dir --alpha 0.1 --rounds 100000 --num_data 50000 --lr 0.2 --num_users 5 --norm_layer GroupNorm --log_every_round 500 --id harry/tensorboard/BN_step_1_shards > harry/GN_step1.txt
# python3 main_fl_clean_old.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 500  -b 20 --frac 1 --method dir --alpha 0.1 --rounds 4000 --num_data 50000 --lr 0.02 --num_users 5 --norm_layer GroupNorm --log_every_round 20 --id harry/tensorboard/BN_step_20_shards > harry/GN_step500.txt
# python3 main_fl_clean_old.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 2500  -b 20 --frac 1 --method dir --alpha 0.1 --rounds 800 --num_data 50000 --lr 0.02 --num_users 5 --norm_layer GroupNorm --log_every_round 4 --id harry/tensorboard/BN_step_100_shards > harry/GN_step2500.txt
# python3 main_fl_clean_old.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 5000  -b 20 --frac 1 --method dir --alpha 0.1 --rounds 400 --num_data 50000 --lr 0.02 --num_users 5 --norm_layer GroupNorm --log_every_round 2 --id harry/tensorboard/BN_step_100_shards > harry/GN_step5000.txt
# python3 main_fl_clean.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 1  -b 20 --frac 1 --method dir --alpha 0.1 --rounds 100000 --num_data 50000 --lr 0.2 --num_users 5 --norm_layer GroupNorm --log_every_round 500 --id harry/tensorboard/BN_step_1_shards_2 > harry/GN_step1_2.txt
# python3 main_fl_clean_old.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 500  -b 20 --frac 1 --method dir --alpha 0.1 --rounds 4000 --num_data 50000 --lr 0.02 --num_users 5 --norm_layer GroupNorm --log_every_round 20 --id harry/tensorboard/BN_step_20_shards_2 > harry/GN_step500_2.txt
# python3 main_fl_clean_old.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 2500  -b 20 --frac 1 --method dir --alpha 0.1 --rounds 800 --num_data 50000 --lr 0.02 --num_users 5 --norm_layer GroupNorm --log_every_round 4 --id harry/tensorboard/BN_step_100_shards_2 > harry/GN_step2500_2.txt

python3 main_fl_clean_old.py --dataset cifar10 -a resnet20 --print-freq 100 --steps 5000  -b 20 --frac 0.1 --method dir --alpha 0.1 --rounds 128 --lr 0.1 --num_users 5 --norm_layer GroupNorm --log_every_round 10 --id nips/tensorboard/BN_step_100_shards_2 > nips/GN_step5000_2.txt